\section{Data Preprocessing}
We divided the \textit{Preprocessing} into two phases. 

In the first phase, which involved preparing the dataset, we performed all the transformations and cleaning operations that did not involve the risk of \textit{data leakage}, applying them to the entire dataset before splitting it into training and testing. 

In the second phase, however, we applied the transformations that could introduce data leakage exclusively to the training set, with the sole exception of imputing missing values: in this case, the \textit{KNN}\footnote{K-Nearest Neighbors} Imputer was trained on the training set and then used for both training and testing, to ensure consistency and avoid leakage. Preprocessing has in turn been divided into: \textit{Data Cleaning}, \textit{Data Transformation}, \textit{Outlier Detection} and \textit{Data Reduction}. 

\subsection{Data Preparation}
\begin{itemize}
	\item \textbf{Selection of baseline visits only:} The first clinical-operational choice was to work only on baseline visits (VISCODE == "bl"), because the goal is to predict the diagnosis based on the information collected at the first visit; 
	\item \textbf{SMC diagnosis management:} Records with \textit{DX\_bl} = SMC were realigned using the DX variable and ultimately classified as "CN", for the reasons stated in the chapter "Multiclass Problem"; 
	\item \textbf{Consolidating bl columns:} Clean up duplicates and merge "baseline" values into main columns;
	\item \textbf{Dirty value handling:} Deleting row with RAVLT\_perc\_forgetting = -316.667 and RAVLT\_forgetting = -19;
	\item \textbf{Text category cleaning (ethnicity, race, marriage):} String values standardized to improve readability and avoid inconsistencies;
	\item \textbf{Encoding of categorical variables:} One-hot encoding (PTETHCAT, PTMARRY), binary mapping (PTGENDER: Male=1, Female=0) and ordinal encoding for DX (CN=0, EMCI=1, LMCI=2, AD=3).
	\item \textbf{Preliminary Feature Reduction:} Removal of columns not relevant to the diagnosis;
	\item \textbf{Splitting train/test:} \textit{Separation into training and test sets while avoiding leakage.}
\end{itemize}

\subsection{Data Cleaning}
\begin{itemize}
	\item \textbf{Handling missing values:} Identifying percentages of missing values and using KNN Imputer for continuous variables ;
	\item \textbf{Numeric Value Conversion:} Convert cognitive scales and age from float to int, correcting for approximations due to imputation or format errors.
\end{itemize}

\subsection{Data Transformation}
\begin{itemize}
	\item \textbf{Creation of new CSF metrics:} \textit{TAU/ABETA} and \textit{PTAU/ABETA} ratios more predictive than single measures according to the literature;
	\item \textbf{MRI normalization to ICV (Intracranial Volume):}
	Necessary to correct for differences due to gender and cranial size.
\end{itemize}

\subsection{Outlier Detection}
\begin{itemize}
	\item \textbf{Univariate Analysis:} use IQR and Z-score for each column to find outliers;
	\item \textbf{Multivariate Analysis:} Constructs groups (EcogPt, EcogSP, Neuropsych, MRI, MRI/ICV, CSF, CSF/ABETA, mPACC), applies \textit{LOF} and \textit{DBSCAN} to normalized data (\textit{RobustScaler}\footnote{$x'_i = \frac{x_i - \text{median}(X)}{Q_3(X)-Q_1(X)}$}). Only data points reported by both techniques and with a \textit{LOF\_score} greater than 2 are kept to flag them as "extreme";
	\item \textbf{Cleaning up problematic outliers:} Outliers with values that were clearly out of range and therefore deemed highly unlikely were replaced with the mean by class.
\end{itemize}

\subsection{Data Reduction}
\begin{itemize}
	\item \textbf{Removal of redundant features:} \textit{ADAS11}, \textit{ADASQ4}, \textit{EcogPtTotal}, \textit{EcogSPTotal}, \textit{mPACCtrailsB}, and \textit{TAU} were removed because they had a high correlation with other features and their informative value was low;
	\item \textbf{Attribute Subset Selection:} I apply four selection methods to the train: \textit{Pearson correlation} ($|r| \ge 0.6$), \textit{mutual information} (top 25), \textit{SelectKBest f\_classif} ($k=25$), and \textit{Recursive Feature Elimination} (RFE with Random Forest). It combines the results by counting how many times each feature appears and retains those selected at least three times, plus other features deemed useful even though they were counted less frequently.
\end{itemize}

\subsection{Some Considerations}
\subsubsection{Correlation}
The dataset contains groups of highly correlated variables (e.g., different neuropsychological scores, ECG components, and MRI volumetric measurements). Rather than eliminating them through aggressive reduction, we decided to retain them and rely on models that are intrinsically robust to correlation.
This choice was motivated by two main reasons:
\begin{enumerate}
	\item \textbf{Clinical interpretability:} Correlated variables can describe different facets of the same function or biomarker. Removing them would impoverish medical interpretation;
	\item \textbf{Complementary predictive value:} Even correlated measures may contain specific variance useful for distinguishing clinical subgroups.
\end{enumerate}

\subsubsection{Normalization}
During the data preparation process, no global normalization or standardization was applied to all variables. 

This choice was driven by one reason: we wanted to \textbf{preserve the clinical interpretability}. Maintaining variables in their original units facilitates the medical interpretation of the results and comparability with clinical reference values. Normalization would have made it more difficult to attribute direct clinical significance to the transformed values.

\newpage

\begin{table}[H]
	\small
	\centering
	\caption{Description of the final dataset attributes}
	\label{tab:dataset-attributes}
	\begin{adjustbox}{max width=\textwidth}
		\begin{tabularx}{\textwidth}{>{\raggedright\arraybackslash}p{3cm} >{\raggedright\arraybackslash}X >{\raggedright\arraybackslash}p{3cm}}
			\toprule
			\textbf{Attribute} & \textbf{Description} & \textbf{Category} \\
			\midrule
			DX                    & Clinical diagnosis at the time of visit: CN, SMC, EMCI, LMCI, AD                   & Diagnosis             \\
			AGE                   & Participant’s age at time of visit                                                 & Demographics          \\
			PTGENDER              & Participant's gender (Male/Female)                                                 & Demographics          \\
			PTEDUCAT              & Years of formal education completed                                                & Demographics          \\
			APOE4                 & Number of APOE $\varepsilon$4 alleles (0, 1, or 2), a genetic risk factor for Alzheimer’s      & Demographics          \\
			MMSE                  & Mini-Mental State Examination score (0–30, higher = better)                        & Clinical Scores       \\
			CDRSB                 & Clinical Dementia Rating - Sum of Boxes (0–18, higher = worse)                     & Clinical Scores       \\
			ADAS13                & ADAS-Cog 13-item total score (higher = worse)                                      & Clinical Scores       \\
			LDELTOTAL             & Logical Memory II delayed recall total score                                       & Clinical Scores       \\
			FAQ                   & Functional Activities Questionnaire – functional impairment score                  & Clinical Scores       \\
			MOCA                  & Montreal Cognitive Assessment – global cognitive function (0–30)                   & Clinical Scores       \\
			TRABSCOR              & Trail Making Test Part B – time in seconds (higher = worse)                        & Clinical Scores       \\
			RAVLT\_immediate       & RAVLT total immediate recall score (sum over 5 trials)                             & Clinical Scores       \\
			RAVLT\_learning        & Learning score (Trial 5 minus Trial 1 of RAVLT)                                    & Clinical Scores       \\
			RAVLT\_perc\_forgetting & ~~Percent forgetting from RAVLT (higher = worse)                                     & Clinical Scores       \\
			mPACCdigit            & Modified Preclinical Alzheimer’s Cognitive Composite – Digit Symbol test           & Composite Scores      \\
			EcogPtMem             & Subject self-reported memory complaints (ECog)                                     & ECogPT                \\
			EcogPtLang            & Subject self-reported language difficulties (ECog)                                 & ECogPT                \\
			EcogPtVisspat         & Subject self-reported visuospatial difficulties (ECog)                             & ECogPT                \\
			EcogPtPlan            & Subject self-reported planning difficulties (ECog)                                 & ECogPT                \\
			EcogPtOrgan           & Subject self-reported organizational issues (ECog)                                 & ECogPT                \\
			EcogPtDivatt          & Subject self-reported divided attention issues (ECog)                              & ECogPT                \\
			EcogSPMem             & Informant-reported memory complaints (ECog)                                        & ECogSP                \\
			EcogSPLang            & Informant-reported language issues (ECog)                                          & ECogSP                \\
			EcogSPVisspat         & Informant-reported visuospatial issues (ECog)                                      & ECogSP                \\
			EcogSPPlan            & Informant-reported planning problems (ECog)                                        & ECogSP                \\
			EcogSPOrgan           & Informant-reported organization issues (ECog)                                      & ECogSP                \\
			EcogSPDivatt          & Informant-reported divided attention issues (ECog)                                 & ECogSP                \\
			FDG                   & FDG PET SUVR – brain glucose metabolism                                            & Biomarkers            \\
			PTAU/ABETA            & CSF phosphorylated tau protein/A$\beta$42 ratio                                     & Biomarkers            \\
			Hippocampus/ICV       & Volume of hippocampus/Intracranial volume ratio from MRI                           & MRI                   \\
			Entorhinal/ICV        & Volume of the entorhinal cortex/Intracranial volume ratio from MRI                 & MRI                   \\
			Fusiform/ICV          & Fusiform gyrus volume/Intracranial volume ratio from MRI                           & MRI                   \\
			MidTemp/ICV           & Middle temporal gyrus volume/Intracranial volume ratio from MRI                    & MRI                   \\
			Ventricles/ICV        & Volume of ventricles/Intracranial volume ratio from MRI                            & MRI                   \\
			WholeBrain/ICV        & Whole brain volume/Intracranial volume ratio from MRI                              & MRI                   \\
			\bottomrule
		\end{tabularx}
	\end{adjustbox}
\end{table}

\newpage
